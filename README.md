# Classification_IBS_Patient_By_Metabolite
## โรคลำไส้แปรปรวน (irritable bowel syndrome หรือ IBS)  
- โรคลำไส้แปรปรวน (irritable bowel syndrome หรือ IBS)  เป็นโรคของลำไส้ที่ทำงานผิดปกติไป ทำให้เกิดการปวดท้องร่วมกับมีอาการท้องเสียหรือท้องผูก หรือท้องเสียสลับกับท้องผูก โดยที่ตรวจไม่พบพยาธิสภาพที่ลำไส้ เช่น ส่องกล้องตรวจลำไส้จะไม่มีอาการอักเสบ ไม่แผลไม่มีเนื้องอกหรือมะเร็ง รวมทั้งไม่มีโรคของอวัยวะอื่น ๆ ที่จะมีผลให้การทำงานของลำไส้ผิดปกติ เช่นโรคต่อมไทรอยด์เป็นพิษ หรือโรคเบาหวานเป็นต้น โรคลำไส้ทำงานแปรปรวนจะเป็นโรคเรื้อรังอาจเป็นปี ๆ หรืออาจเป็นตลอดชีวิต เป็นโรคที่ไม่ทำให้สุขภาพเสื่อมโทรม แม้จะเป็นมาหลาย ๆ ปี และไม่ทำให้เกิดอันตรายถึงแก่ชีวิต แต่เป็นโรคที่สร้างความรำคาญ และความทุกข์ทรมานให้ผู้ป่วยอย่างมากได้ 
## การตรวจวินิจฉัยโรคลำไส้แปรปรวน
- จากพยาธิสรีรวิทยาและกลไกการเกิดโรคที่ซับซ้อนบอกให้ทราบว่า โรคลำไส้แปรปรวน IBS เป็นความผิดปกติในระดับเซลล์ มองไม่เห็นด้วยตาเปล่าและไม่สามารถจับต้องได้ การตรวจทางห้องปฏิบัติการ หรือภาพเอกซเรย์ช่องท้อง รวมถึงการส่องกล้องตรวจลำไส้ใหญ่จะให้ผลเป็นปกติในขณะเดียวกันอาการของโรคลำไส้แปรปรวน IBS จะมีความคล้ายคลึงกับ โรคลำไส้ชนิดอื่น ๆ ด้วย เช่น โรคลำไส้อักเสบจากการติดเชื้อโรคต่าง ๆ (เช่น เชื้อแบคทีเรีย พยาธิ โปรโตซัว เอชไอวี วัณโรคลงลำไส้), ลำไส้เป็นแผล, โรคลำไส้อักเสบเรื้อรัง IBD  และนอกจากนั้นในทางพยาธิสรีรวิทยา พบว่าจุลินทรีย์ในลำไส้และ metabolites สามารถตรวจและแยกประเภทโรคลำไส้แปรปรวนได้ 
## วัตถุประสงค์
- เพื่อสร้างตัวแบบ Machine Learning จำแนกประเภท ระหว่าง ผู้เป็นโรคลำไส้แปรปรวน และผู้ที่ไม่เป็น จากสาร Metabolite และ หาว่าสาร Metabolite ชนิดใดที่แต่ต่างระหว่างผู้ที่เป็นโรคลำไว้แปรปรวน และไม่เป็น
- ตัวแบบ Machine Learning จำแนกประเภท ที่ได้ต้องมี AUC score สูงกว่างานวิจัยหลักที่ใช้ https://microbiomejournal.biomedcentral.com/articles/10.1186/s40168-022-01450-5#availability-of-data-and-materials ที่ใช้ Random Foresrt กับ dataset ชุดเดียวกัน ซึ่งมี AUC score อยู่่ที่ 0.82
## Data
- ในการศึกษานี้ใช้สาร Metabolite ที่สกัดจากอุจจาระ โดยตัวข้อมูลประกอบด้วย metabolite 601 ชนิด และ column ที่ระบุว่าเป็นผู้ป่วยหรือ กลุ่ม healthy controls รวม 602 columns
และ มีผู้ป่วยโรคลำไส้แปรปรวน 229 คน กลุ่ม healthy controls 139 คน โดย data set ชุดนี้ไม่มี Missing values
## วิธีที่ใช้
- โดยวิธีที่ใช้นั้นจะมีการทำ Feature selection ก่อนเข้า Classification Model
### Feature selection
- ในส่วนของการทำ Feature selection จะใช้ Forward Selection, Backward Elimination โดย ForwForward Selection เป็นการสร้างโมเดลโดยการเพิ่มฟีเจอร์ทีละ 1 ฟีเจอร์ ถ้าฟีเจอร์ที่ใส่เพิ่มให้ประสิทธิภาพที่ดีก็จะเก็บไว้และเลือกฟีเจอร์อื่นๆ มาเพิ่มต่อไปจนประสิทธิภาพของโมเดลไม่ได้ดีขึ้นก็จะหยุดทำงาน Backward Elimination เป็นการสร้างโมเดลที่เริ่มจากการใช้ฟีเจอร์ทั้งหมดก่อนและตัด (eliminate) ฟีเจอร์ที่ไม่สำคัญทิ้งไปทีละฟีเจอร์ถ้าประสิทธิภาพดีขึ้นก็ตัดฟีเจอร์อื่นๆ ต่อไป และ เนื่องจากข้อมูลที่ใช้มีตัวแปรอิสระ (X) เป็นNumeric และตัวแปรตาม (y) เป็น category จึงเลือกใช้ Linear discriminant analysis (LDA) ในการวัดค่า Coeficient ของ ตัวแปรอิสระ (X) แต่ละตัวที่ส่งผลต่อตัวแปรอิสระ (X)
- และเนื่องจาก Forward Selection, Backward Elimination เป็นวิธีการ เป็นการคัดเลือกฟีเจอร์ด้วยการสร้างโมเดล (classification model) ขึ้นมาจากเซตของฟีเจอร์ที่กำหนดไว้และวัดประสิทธิภาพการทำงานของโมเดล และเลือกเซตของฟีเจอร์ที่ทำให้โมเดลมีประสิทธิภาพมากที่สุดมาใช้งาน ซึ่งอาจจะไม่สามารถอธิบายได้ว่า Feature แต่ละตัวส่งผล ตัวแปรตาม (y) จริงหรือไม่ จึงเลือกใช้ anova ทำ Feature selection โดยทดสอบ  Feature แต่ละตัวเทียบกับ Forward Selection, Backward Elimination
